<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç WebTorrent Player</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .magnet-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            font-family: monospace;
            font-size: 12px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .error {
            color: #dc3545;
            background: #f8d7da;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
        .success {
            color: #155724;
            background: #d4edda;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
        .info {
            background: #d1ecf1;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç WebTorrent Player</h1>
        
        <div class="info">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ—Å—Ç–µ:</h3>
            <p>–≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø–æ–º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤–µ–±—Ç–æ—Ä—Ä–µ–Ω—Ç –ø–ª–µ–µ—Ä–∞. –í—Å—Ç–∞–≤—å—Ç–µ magnet —Å—Å—ã–ª–∫—É –Ω–∏–∂–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–û—Ç–∫—Ä—ã—Ç—å –ø–ª–µ–µ—Ä".</p>
            <p><strong>–í–∞–∂–Ω–æ:</strong> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ <code>http://localhost:8080</code></p>
        </div>

        <div>
            <label for="magnetInput"><strong>Magnet —Å—Å—ã–ª–∫–∞:</strong></label>
            <textarea id="magnetInput" class="magnet-input" rows="4" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ magnet —Å—Å—ã–ª–∫—É —Å—é–¥–∞...">magnet:?xt=urn:btih:8dad31777d233d07f2a8179abff3ff0b5771731e&dn=rutor.info&tr=udp%3a%2f%2fopentor.net%3a6969&tr=http%3a%2f%2fretracker.local%2fannounce&tr=http%3a%2f%2fbt2.t-ru.org%2fann&tr=udp%3a%2f%2fopen.stealth.si%3a80%2fannounce&tr=udp%3a%2f%2ftracker.bitsearch.to%3a1337%2fannounce&tr=udp%3a%2f%2ftracker.dler.com%3a6969%2fannounce&tr=udp%3a%2f%2fexodus.desync.com%3a6969%2fannounce&tr=http%3a%2f%2fbt4.t-ru.org%2fann&tr=https%3a%2f%2ftracker.yemekyedim.com%3a443%2fannounce&tr=https%3a%2f%2ftracker.gcrenwp.top%3a443%2fannounce&tr=http%3a%2f%2fwww.all4nothin.net%3a80%2fannounce.php&tr=http%3a%2f%2ftracker.renfei.net%3a8080%2fannounce&tr=http%3a%2f%2ftracker.bt4g.com%3a2095%2fannounce&tr=http%3a%2f%2ftracker-zhuqiy.dgj055.icu%3a80%2fannounce&tr=http%3a%2f%2ft.nyaatracker.com%3a80%2fannounce&tr=http%3a%2f%2fnyaa.tracker.wf%3a7777%2fannounce&tr=http%3a%2f%2fbt.okmp3.ru%3a2710%2fannounce&tr=http%3a%2f%2ftracker.grepler.com%3a6969%2fannounce&tr=http%3a%2f%2fh4.trakx.nibba.trade%3a80%2fannounce&tr=udp%3a%2f%2ftracker.opentrackr.org%3a1337%2fannounce&tr=udp%3a%2f%2ftracker.torrent.eu.org%3a451%2fannounce&tr=http%3a%2f%2ftracker.mywaifu.best%3a6969%2fannounce&tr=udp%3a%2f%2fwepzone.net%3a6969%2fannounce&tr=udp%3a%2f%2fd40969.acod.regrucolo.ru%3a6969%2fannounce&tr=udp%3a%2f%2fttk2.nbaonlineservice.com%3a6969%2fannounce&tr=udp%3a%2f%2ftracker.fnix.net%3a6969%2fannounce</textarea>
        </div>

        <div>
            <button class="test-button" onclick="openPlayer()">üé¨ –û—Ç–∫—Ä—ã—Ç—å –ø–ª–µ–µ—Ä</button>
            <button class="test-button" onclick="testMagnetValidation()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å magnet —Å—Å—ã–ª–∫—É</button>
            <button class="test-button" onclick="clearResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>

        <div id="results"></div>
    </div>

    <script>
        function openPlayer() {
            const magnetLink = document.getElementById('magnetInput').value.trim();
            
            if (!magnetLink) {
                showResult('–í–≤–µ–¥–∏—Ç–µ magnet —Å—Å—ã–ª–∫—É', 'error');
                return;
            }

            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ magnet —Å—Å—ã–ª–∫–∞
                if (!magnetLink.startsWith('magnet:?')) {
                    showResult('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç magnet —Å—Å—ã–ª–∫–∏. –°—Å—ã–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å "magnet:?"', 'error');
                    return;
                }

                // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–ª–µ–µ—Ä
                const encodedMagnet = encodeURIComponent(magnetLink);
                const playerUrl = `http://localhost:8080/api/v1/webtorrent/player?magnet=${encodedMagnet}`;
                
                showResult(`–û—Ç–∫—Ä—ã–≤–∞—é –ø–ª–µ–µ—Ä: ${playerUrl}`, 'success');
                
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
                window.open(playerUrl, '_blank', 'fullscreen=yes');
                
            } catch (error) {
                showResult(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–ª–µ–µ—Ä–∞: ${error.message}`, 'error');
            }
        }

        function testMagnetValidation() {
            const magnetLink = document.getElementById('magnetInput').value.trim();
            
            if (!magnetLink) {
                showResult('–í–≤–µ–¥–∏—Ç–µ magnet —Å—Å—ã–ª–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏', 'error');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã magnet —Å—Å—ã–ª–∫–∏
            const checks = [
                { name: '–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å magnet:?', test: magnetLink.startsWith('magnet:?') },
                { name: '–°–æ–¥–µ—Ä–∂–∏—Ç xt=urn:btih:', test: magnetLink.includes('xt=urn:btih:') },
                { name: '–°–æ–¥–µ—Ä–∂–∏—Ç info hash', test: /xt=urn:btih:[a-fA-F0-9]{40}/.test(magnetLink) },
                { name: '–î–ª–∏–Ω–∞ —Å—Å—ã–ª–∫–∏ —Ä–∞–∑—É–º–Ω–∞—è', test: magnetLink.length > 50 && magnetLink.length < 5000 }
            ];

            let results = '<h4>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:</h4>';
            let allPassed = true;

            checks.forEach(check => {
                const status = check.test ? '‚úÖ' : '‚ùå';
                const color = check.test ? 'green' : 'red';
                results += `<p style="color: ${color}">${status} ${check.name}</p>`;
                if (!check.test) allPassed = false;
            });

            if (allPassed) {
                results += '<p style="color: green; font-weight: bold;">‚úÖ Magnet —Å—Å—ã–ª–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!</p>';
            } else {
                results += '<p style="color: red; font-weight: bold;">‚ùå Magnet —Å—Å—ã–ª–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫–∏!</p>';
            }

            showResult(results, allPassed ? 'success' : 'error');
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        function showResult(message, type) {
            const resultsDiv = document.getElementById('results');
            const className = type === 'error' ? 'error' : 'success';
            resultsDiv.innerHTML = `<div class="${className}">${message}</div>`;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            const magnetLink = document.getElementById('magnetInput').value;
            if (magnetLink) {
                testMagnetValidation();
            }
        };
    </script>
</body>
</html>